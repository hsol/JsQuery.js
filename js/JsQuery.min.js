/*
 https://github.com/hsol/JsQuery.js
 The MIT License (MIT) Copyright (c) 2016 HansolLim
 */
!function(root){Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var r=Object(this),t=r.length>>>0;if("function"!=typeof e)throw new TypeError;for(var o=[],i=arguments.length>=2?arguments[1]:void 0,n=0;t>n;n++)if(n in r){var c=r[n];e.call(i,c,n,r)&&o.push(c)}return o}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),root.JsQuery=function(object,query){var _jsQuery=this;_jsQuery._object=null,_jsQuery._query=null,object&&(_jsQuery._object=object),query&&(_jsQuery._query=query),_jsQuery.setObject=function(e){"object"==typeof e?_jsQuery._object=e:console.error("parameter type error.")},_jsQuery.setQuery=function(e){"string"==typeof e?_jsQuery._query=e:console.error("parameter type error.")},_jsQuery.getObject=function(){return _jsQuery._object},_jsQuery.getQuery=function(){return _jsQuery._query},_jsQuery.getResult=function(object,query){if(object=object||_jsQuery._object,query=query||_jsQuery._query,object&&query){var isContainWhere=-1!=query.indexOf("WHERE"),isContainOrder=-1!=query.indexOf("ORDER"),queryObject={columns:[],condition:{where:"",order:""}};if(isContainWhere&&isContainOrder?query.indexOf("WHERE")>query.indexOf("ORDER")?(queryObject.columns=query.split("ORDER")[0].replace(new RegExp(" ","gi"),"").split(","),queryObject.condition.order=query.split("ORDER")[1].split("WHERE")[0].trim(),queryObject.condition.where=query.split("ORDER")[1].split("WHERE")[1].trim()):(queryObject.columns=query.split("WHERE")[0].replace(new RegExp(" ","gi"),"").split(","),queryObject.condition.where=query.split("WHERE")[1].split("ORDER")[0].trim(),queryObject.condition.order=query.split("WHERE")[1].split("ORDER")[1].trim()):isContainWhere?(queryObject.columns=query.split("WHERE")[0].replace(new RegExp(" ","gi"),"").split(","),queryObject.condition.where=query.split("WHERE")[1]):isContainOrder?(queryObject.columns=query.split("ORDER")[0].replace(new RegExp(" ","gi"),"").split(","),queryObject.condition.order=query.split("ORDER")[1]):queryObject.columns=query.replace(new RegExp(" ","gi"),"").split(","),isContainOrder&&queryObject.condition.order)if(queryObject.condition.order=queryObject.condition.order.trim(),"-"!=queryObject.condition.order[0]){for(var key=queryObject.condition.order,i=0;i<object.length;i++)for(var j=i+1;j<object.length;j++)if(object[i][key]>object[j][key]){var temp=object[i];object[i]=object[j],object[j]=temp}}else for(var key=queryObject.condition.order.substring(1,queryObject.condition.order.length),i=0;i<object.length;i++)for(var j=i+1;j<object.length;j++)if(object[i][key]<object[j][key]){var temp=object[i];object[i]=object[j],object[j]=temp}if(isContainWhere){if(queryObject.condition.where){var quotes=!1,quoteString="",quoteArray=[],quoteArrayIndex=0;for(var idx in queryObject.condition.where)quotes?quoteString+=queryObject.condition.where[idx]:quoteString="","'"===queryObject.condition.where[idx]&&(quotes?(quoteArray.push(quoteString),queryObject.condition.where=queryObject.condition.where.replace(quoteString,"["+quoteArrayIndex++ +"]"),idx-=quoteString.length-("["+idx+"]").length):quoteString+=quoteString+=queryObject.condition.where[idx],quotes=!quotes);queryObject.condition.variable=quoteArray,queryObject.condition.where=queryObject.condition.where.replace(new RegExp(" ","gi"),"");for(var objectIdx in object){var condition=queryObject.condition.where;for(var key in object[objectIdx])condition="string"==typeof object[objectIdx][key]?condition.replace(key,"'"+object[objectIdx][key]+"'"):condition.replace(key,object[objectIdx][key]);for(var quoteIdx in quoteArray)condition=condition.replace("["+quoteIdx+"]",quoteArray[quoteIdx]);if(eval(condition))for(var key in object[objectIdx]){var isExist=!1;for(var columnIdx in queryObject.columns)key==queryObject.columns[columnIdx]&&(isExist=!0);isExist||delete object[objectIdx][key]}else delete object[objectIdx]}}object=object.filter(function(e){return e})}return object}console.error("JsQuery Error. object or query is null,")}}}(window);